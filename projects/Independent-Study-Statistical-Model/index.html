<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>IS Analyzer Project | Patrick May</title> <meta name="author" content="Patrick May"> <meta name="description" content="An applied statistics project involving heaving webscraping and NLP processing"> <meta name="keywords" content="jekyll, jekyll-theme, portfolio-website"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%92%BB&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://patrick-may.github.io/projects/Independent-Study-Statistical-Model/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Patrick </span>May</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories</a> </li> <li class="nav-item "> <a class="nav-link" href="/resume/">resume</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">IS Analyzer Project</h1> <p class="post-description">An applied statistics project involving heaving webscraping and NLP processing</p> </header> <article> <h1 id="hello-statistics">Hello Statistics!</h1> <p>This project spawned initially from an opportunity presented to me through my penultimate semester coursework. At the College of Wooster, I took <em>DATA-230: Applied Statistics</em> as a foray into the world of statistics and data science. 4-year-old high school statistics was really pulling its weight for me at the beginning of this course… ‘Applied Statistics’ is a course that has been just that – applied, primarily covering linear and logistic regressions in the context of applying and fitting various models to real world datasets. A substantial portion of the course has been building towards a free-form final project that is basically “go do statistics”. Of course, the project specification is sleighted towards working with existing datasets and building models on that pre-compiled data. As a computer scientist (and wanting an excuse to learn some webscraping and data processing), I instead immediately turned into the figurative brush in trying to first <strong>build my own dataset</strong> before using that data to play around with. In a sense, this meant I did non-trivial work just to get to the starting point of my other peers, but thanks to an ammenable instructor, we modified the expectations of the project enough such that I still did statistics while accounting for the extra effort done in step 0.</p> <p>Pre-preamble… complete!</p> <h1 id="motivation-and-context">Motivation and Context</h1> <p>At the College of Wooster (my undergraduate institution), there is substantial importance placed on our “<strong>Independent Study</strong>” project. Our Independent Studies are year-long independent, individual research projects in the realm of each student’s chosen major(s). As a senior in the computer science department, I am working on my own IS – separate from this statistics project. Refer to other posts and pages on my site if you are interested in static analysis and understanding energy usage of programs. Back to an overview of ISes, each department differs somewhat, but generally each week seniors check in with an advisor in their department, who may or may not be an expert in the specific topic of the IS. To be pompous, Independent Study is a very souped up version of a senior thesis at other institutions. Although I do not believe college rankings and special ranklists are anywhere near honest, for the last 20-ish years, <a href="https://wooster.edu/academics/research/" rel="external nofollow noopener" target="_blank">Wooster has been a premier undergraduate mentored research institution</a>.</p> <p>I am not experienced in the machine learning space, but with increasingly ease of accessibility of generative AI, for the last year or so I was playing around with a dream to tune a GPT to independent studies and see the results – for humor’s sake.<br> At this time, I was unaware of <em>where</em> I could collect IS training data, but at the beginning of the year I came across our college’s <a href="https://openworks.wooster.edu/" rel="external nofollow noopener" target="_blank">OpenWorks page</a>.</p> <center><b>Bingo.</b></center> <p>Now I have a source for where to collect data, as there is an “Independent Studies” publications page on Openworks. I also was reviewing final project writeups at this time, and saw that my statistics class was very open ended. <em>This is a perfect excuse to harvest all this data</em> <del>for personal project use</del> for a course project. I just need to <em>do</em> the collection.</p> <h1 id="webscraping-go-colly-and-you">Webscraping, Go, Colly, and You</h1> <p>My day job involves a lot of Selenium Automation in Groovy. My first thought for webscraping is exactly that – lets do some kind of Selenium based script. After some quick googling, I saw some discussion that webscraping with a browser automation tool may be using too powerful of a tool for the desired data collection. At the time, I was interested in poking around in Go, so a quick ‘Go Webscraping’ search later, I found myself point at <a href="https://go-colly.org/" rel="external nofollow noopener" target="_blank">GoColly</a>. Understand that this webscraping script is my first real <code class="language-plaintext highlighter-rouge">Go</code> code I’ve written, so some style may be forgone as I still cling onto my jumbled internalized program representation.</p> <p>If I’m doing some webscraping, lets peek into what an IS page on openworks <a href="https://openworks.wooster.edu/independentstudy/10559/" rel="external nofollow noopener" target="_blank">looks like</a></p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/isthesismetadata.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/isthesismetadatainspect.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p><code class="language-plaintext highlighter-rouge">Colly</code>, from the limited usage I interacted with it, feels almost ‘functional’-style in how it operates. Lets do a quick look-over to haskell:</p> <div class="language-hs highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="n">fib1</span> <span class="o">::</span> <span class="p">(</span><span class="kt">Integer</span><span class="p">,</span> <span class="kt">Integer</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Integer</span>
<span class="n">fib1</span> <span class="mi">0</span> <span class="o">=</span> <span class="mi">1</span> 
<span class="n">fib1</span> <span class="mi">1</span> <span class="o">=</span> <span class="mi">1</span> 
<span class="n">fib1</span> <span class="n">n</span> <span class="o">=</span> <span class="n">fib1</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">fib2</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1">-- Or, in my very rudimentary haskell knowledge, we can understand pattern matching like so:</span>

<span class="o">&lt;</span><span class="n">func_name</span><span class="o">&gt;</span> <span class="o">::</span> <span class="o">&lt;</span><span class="kt">Types</span><span class="o">...&gt;</span> <span class="o">-&gt;</span> <span class="o">&lt;</span><span class="kt">ReturnType</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">func_name</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">pattern1</span><span class="o">&gt;</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">response1</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">func_name</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">pattern2</span><span class="o">&gt;</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">response2</span><span class="o">&gt;</span>
<span class="o">...</span>

</code></pre></div></div> <p>Long story short, we are defining certain <strong>patterns</strong> that, when encountered, have certain <strong>responses</strong>. For a fibonacci, if we reach 0 or 1, we are a known base case, otherwise for an unknown value, the response is a recursive functional call. It makes sense… to me… somewhat. Maybe this functional foray helps, perhaps not. But lets look at the main body of the webscraping code:</p> <div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">// define our collector variable</span>
<span class="n">c</span> <span class="o">:=</span> <span class="n">colly</span><span class="o">.</span><span class="n">NewCollector</span><span class="p">(</span>
    <span class="c">// Don't go OOB</span>
    <span class="n">colly</span><span class="o">.</span><span class="n">AllowedDomains</span><span class="p">(</span><span class="s">"openworks.wooster.edu"</span><span class="p">),</span>
<span class="p">)</span>

<span class="c">// rate limits</span>
<span class="n">c</span><span class="o">.</span><span class="n">Limit</span><span class="p">(</span><span class="o">&amp;</span><span class="n">colly</span><span class="o">.</span><span class="n">LimitRule</span><span class="p">{</span>
    <span class="n">DomainGlob</span><span class="o">:</span> <span class="s">"*openworks.wooster.*"</span><span class="p">,</span>
    <span class="n">RandomDelay</span><span class="o">:</span> <span class="m">5</span> <span class="o">*</span> <span class="n">time</span><span class="o">.</span><span class="n">Second</span><span class="p">,</span>
<span class="p">})</span>

<span class="c">// debugging purposes</span>
<span class="n">c</span><span class="o">.</span><span class="n">OnResponse</span><span class="p">(</span><span class="k">func</span><span class="p">(</span><span class="n">r</span> <span class="o">*</span><span class="n">colly</span><span class="o">.</span><span class="n">Response</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"</span><span class="se">\t</span><span class="s">Visited"</span><span class="p">,</span> <span class="n">r</span><span class="o">.</span><span class="n">Request</span><span class="o">.</span><span class="n">URL</span><span class="p">)</span>
<span class="p">})</span>

<span class="c">// Find and print all links in main body page, visit them</span>
<span class="n">c</span><span class="o">.</span><span class="n">OnHTML</span><span class="p">(</span><span class="s">"p.article-listing"</span><span class="p">,</span> <span class="k">func</span> <span class="p">(</span><span class="n">e</span> <span class="o">*</span><span class="n">colly</span><span class="o">.</span><span class="n">HTMLElement</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">link</span> <span class="o">:=</span> <span class="n">e</span><span class="o">.</span><span class="n">ChildAttr</span><span class="p">(</span><span class="s">"a"</span><span class="p">,</span> <span class="s">"href"</span><span class="p">)</span>
    <span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"Visiting: "</span><span class="p">,</span> <span class="n">link</span><span class="p">)</span>
    <span class="n">c</span><span class="o">.</span><span class="n">Visit</span><span class="p">(</span><span class="n">link</span><span class="p">)</span>

<span class="p">})</span>

<span class="c">// pagination </span>
<span class="n">c</span><span class="o">.</span><span class="n">OnHTML</span><span class="p">(</span><span class="s">"div.adjacent-pagination"</span><span class="p">,</span> <span class="k">func</span> <span class="p">(</span><span class="n">e</span> <span class="o">*</span><span class="n">colly</span><span class="o">.</span><span class="n">HTMLElement</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">currentPage</span> <span class="o">:=</span> <span class="n">e</span><span class="o">.</span><span class="n">ChildText</span><span class="p">(</span><span class="s">"li.active a"</span><span class="p">)</span>
    <span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"Current page is "</span><span class="p">,</span> <span class="n">currentPage</span><span class="p">)</span>
    
    <span class="n">nextpg</span> <span class="o">:=</span> <span class="n">nextPageStr</span><span class="p">(</span><span class="n">currentPage</span><span class="p">)</span>   
    <span class="n">fstr</span> <span class="o">:=</span> <span class="s">"div.adjacent-pagination li a[title='"</span> <span class="o">+</span> <span class="n">nextpg</span> <span class="o">+</span> <span class="s">"']"</span>
    <span class="n">nextPg</span> <span class="o">:=</span> <span class="n">e</span><span class="o">.</span><span class="n">ChildAttr</span><span class="p">(</span><span class="n">fstr</span><span class="p">,</span> <span class="s">"href"</span><span class="p">)</span>
    <span class="n">c</span><span class="o">.</span><span class="n">Visit</span><span class="p">(</span><span class="n">nextPg</span><span class="p">)</span>
<span class="p">})</span>

<span class="c">// parse all data from metadata page</span>
<span class="n">c</span><span class="o">.</span><span class="n">OnHTML</span><span class="p">(</span><span class="s">"div#content"</span><span class="p">,</span> <span class="k">func</span> <span class="p">(</span><span class="n">e</span> <span class="o">*</span><span class="n">colly</span><span class="o">.</span><span class="n">HTMLElement</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">downl</span> <span class="o">:=</span> <span class="n">e</span><span class="o">.</span><span class="n">ChildAttr</span><span class="p">(</span><span class="s">"a[id='pdf']"</span><span class="p">,</span> <span class="s">"href"</span><span class="p">)</span>
    <span class="n">titl</span> <span class="o">:=</span> <span class="n">e</span><span class="o">.</span><span class="n">ChildText</span><span class="p">(</span><span class="s">"div#title &gt; p"</span><span class="p">)</span>
    <span class="n">aut</span> <span class="o">:=</span> <span class="n">e</span><span class="o">.</span><span class="n">ChildText</span><span class="p">(</span><span class="s">"p.author &gt; a &gt; strong"</span><span class="p">)</span>
    <span class="n">abs</span> <span class="o">:=</span> <span class="n">e</span><span class="o">.</span><span class="n">ChildText</span><span class="p">(</span><span class="s">"div#abstract &gt; p"</span><span class="p">)</span>
    <span class="n">adv</span> <span class="o">:=</span> <span class="n">e</span><span class="o">.</span><span class="n">ChildText</span><span class="p">(</span><span class="s">"div#advisor1 &gt; p"</span><span class="p">)</span>
    <span class="n">dept</span> <span class="o">:=</span> <span class="n">e</span><span class="o">.</span><span class="n">ChildText</span><span class="p">(</span><span class="s">"div#subject_area &gt; p"</span><span class="p">)</span>
    <span class="n">reccite</span> <span class="o">:=</span> <span class="n">e</span><span class="o">.</span><span class="n">ChildText</span><span class="p">(</span><span class="s">"div#recommended_citation &gt; p"</span><span class="p">)</span>
    <span class="n">keys</span> <span class="o">:=</span> <span class="n">e</span><span class="o">.</span><span class="n">ChildText</span><span class="p">(</span><span class="s">"div#keywords &gt; p"</span><span class="p">)</span>
    <span class="n">pubdate</span> <span class="o">:=</span> <span class="n">e</span><span class="o">.</span><span class="n">ChildText</span><span class="p">(</span><span class="s">"div#publication_date &gt; p"</span><span class="p">)</span>    
    <span class="n">deg</span> <span class="o">:=</span> <span class="n">e</span><span class="o">.</span><span class="n">ChildText</span><span class="p">(</span><span class="s">"div#degree_granted &gt; p"</span><span class="p">)</span>
    <span class="n">doctype</span> <span class="o">:=</span> <span class="n">e</span><span class="o">.</span><span class="n">ChildText</span><span class="p">(</span><span class="s">"div#document_type &gt; p"</span><span class="p">)</span>
   
    <span class="c">// strip all tabs</span>
    <span class="n">titl</span> <span class="o">=</span> <span class="n">replacer</span><span class="o">.</span><span class="n">Replace</span><span class="p">(</span><span class="n">titl</span><span class="p">)</span>
    <span class="n">aut</span> <span class="o">=</span> <span class="n">replacer</span><span class="o">.</span><span class="n">Replace</span><span class="p">(</span><span class="n">aut</span><span class="p">)</span>
    <span class="n">abs</span> <span class="o">=</span> <span class="n">replacer</span><span class="o">.</span><span class="n">Replace</span><span class="p">(</span><span class="n">abs</span><span class="p">)</span>
    <span class="n">adv</span> <span class="o">=</span> <span class="n">replacer</span><span class="o">.</span><span class="n">Replace</span><span class="p">(</span><span class="n">adv</span><span class="p">)</span>
    <span class="n">dept</span> <span class="o">=</span> <span class="n">replacer</span><span class="o">.</span><span class="n">Replace</span><span class="p">(</span><span class="n">dept</span><span class="p">)</span>
    <span class="n">reccite</span> <span class="o">=</span> <span class="n">replacer</span><span class="o">.</span><span class="n">Replace</span><span class="p">(</span><span class="n">reccite</span><span class="p">)</span>
    <span class="n">keys</span> <span class="o">=</span> <span class="n">replacer</span><span class="o">.</span><span class="n">Replace</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span>
    <span class="n">pubdate</span> <span class="o">=</span> <span class="n">replacer</span><span class="o">.</span><span class="n">Replace</span><span class="p">(</span><span class="n">pubdate</span><span class="p">)</span>
    <span class="n">deg</span> <span class="o">=</span> <span class="n">replacer</span><span class="o">.</span><span class="n">Replace</span><span class="p">(</span><span class="n">deg</span><span class="p">)</span>
    <span class="n">doctype</span> <span class="o">=</span> <span class="n">replacer</span><span class="o">.</span><span class="n">Replace</span><span class="p">(</span><span class="n">doctype</span><span class="p">)</span>

    <span class="n">paper</span> <span class="o">:=</span> <span class="n">paperMeta</span><span class="p">{</span><span class="n">downl</span><span class="p">,</span> <span class="n">titl</span><span class="p">,</span> <span class="n">aut</span><span class="p">,</span> <span class="n">abs</span><span class="p">,</span> <span class="n">adv</span><span class="p">,</span> <span class="n">dept</span><span class="p">,</span> <span class="n">reccite</span><span class="p">,</span> <span class="n">keys</span><span class="p">,</span> <span class="n">pubdate</span><span class="p">,</span> <span class="n">deg</span><span class="p">,</span> <span class="n">doctype</span><span class="p">}</span>
<span class="p">})</span>

<span class="n">c</span><span class="o">.</span><span class="n">visit</span><span class="p">(</span><span class="s">"https://openworks.wooster.edu/independentstudy/"</span><span class="p">)</span>

</code></pre></div></div> <p>Notably, we define these various <strong>patterns</strong> and specific responses that should occur when they are encountered. I.e. <code class="language-plaintext highlighter-rouge">c.OnHTML("&lt;Go Selector&gt;", func funcToCall (e *colly.HTMLElement{...}))</code>. The last part of this is the concept of ‘Go Selectors’ – which are analagous to CSS Selectors, AFAIK. If you’ve done any web automation, there are many different ways to access various elements on the page (XPaths, Selectors, etc.), so while I am most comfortable with XPaths, trawling some simple Selectors with the aid of developer tools was trivial.</p> <p>Our various encounterings of elements doesn’t matter which order we define them in, which was the weirdest feeling for me. I really only needed 3 patterns to follow: follow pagination on the listings of IS pages, follow links to individual metadata pages, and harvest the data itself on those metadata pages.</p> <p>Ok, so if we are webscraping pages that look like the graphic above, lets make a container for an individual IS in underlying Go Lang:</p> <div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">type</span> <span class="n">paperMeta</span> <span class="k">struct</span> <span class="p">{</span>
    <span class="n">downlink</span>  <span class="kt">string</span>
    <span class="n">title</span>     <span class="kt">string</span>
    <span class="n">author</span>    <span class="kt">string</span>
    <span class="n">abstract</span>  <span class="kt">string</span> 
    <span class="n">advisor</span>   <span class="kt">string</span>
    <span class="n">department</span>    <span class="kt">string</span> 
    <span class="n">reccitation</span>   <span class="kt">string</span> 
    <span class="n">keywords</span>  <span class="kt">string</span> 
    <span class="n">pubdate</span>   <span class="kt">string</span> 
    <span class="n">degree</span>    <span class="kt">string</span> 
    <span class="n">papertype</span> <span class="kt">string</span> 
<span class="p">}</span>
</code></pre></div></div> <p>alrighty… that isn’t so bad! Structs seem pretty approachable, adjacent to C-style structs and arguably analagous to python’s dataclasses. Throw in some information cleaning (stripping escape and spacing characters, for example), write all of them to file, and I now have <strong>~11,600</strong> observations for normal Independent Studies. If I just swap where the outfile goes, and change where the initial webscraper is pointed at, I got another <strong>375</strong> exemplar independent studies quite easily.</p> <p>But, this is all metadata. All I have is a TSV datafile, without any of the <strong>fun</strong> information, like the underlying rawtexts of all these independent studies. To do get those, I needed to somehow <em>download</em> all the papers found at the links in the harvested metadata.</p> <h1 id="selenium-pdf-farm">Selenium PDF Farm</h1> <p>No where near as long, nor as interesting of a subproblem to tackle. Given a long list of links to downloadable PDF forms of Independent Studies, I needed to go and download them. The one complication is that observing these rawtexts is behind an authentication step, as many are limited to only Wooster students (a primary reason why this dataset is NOT published for anyone’s free use). My hackish workaround was to just let me manually log in before yielding control to the automation tool for download requests to all the different links on the page. The only semi-unique step here was adding extra profile steps so that pdf files would be automatically downloaded to a pre-specified folder (for me, an external drive):</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
    <span class="n">profile</span> <span class="o">=</span> <span class="p">{</span><span class="sh">"</span><span class="s">plugins.plugins_list</span><span class="sh">"</span><span class="p">:</span> <span class="p">[{</span><span class="sh">"</span><span class="s">enabled</span><span class="sh">"</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span>
                                         <span class="sh">"</span><span class="s">name</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">Chrome PDF Viewer</span><span class="sh">"</span><span class="p">}],</span>
               <span class="sh">"</span><span class="s">download.default_directory</span><span class="sh">"</span>     <span class="p">:</span> <span class="n">download_folder</span><span class="p">,</span>
               <span class="sh">"</span><span class="s">download.prompt_for_download</span><span class="sh">"</span>   <span class="p">:</span> <span class="bp">False</span><span class="p">,</span>
               <span class="sh">"</span><span class="s">download.directory_upgrade</span><span class="sh">"</span>     <span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
               <span class="sh">"</span><span class="s">download.extensions_to_open</span><span class="sh">"</span>    <span class="p">:</span> <span class="sh">""</span><span class="p">,</span>
               <span class="sh">"</span><span class="s">plugins.always_open_pdf_externally</span><span class="sh">"</span> <span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
               <span class="p">}</span>
    
    <span class="n">options</span><span class="p">.</span><span class="nf">add_experimental_option</span><span class="p">(</span><span class="sh">"</span><span class="s">prefs</span><span class="sh">"</span><span class="p">,</span> <span class="n">profile</span><span class="p">)</span>
    
</code></pre></div></div> <p><em>I now have all the data collected, but not in an easily analyzable form for the stats project, nor in an easily tunable form for an AI, as far as I can tell.</em></p> <p>Of note: I was only able to download rawtexts of ~5,500 Independent studies (both exemplar and non), due to embargo rules. There seems to be a blanket limitation for any IS from 2005 or earlier that makes them unable to be accessed.</p> <h1 id="lexical-analysis">Lexical Analysis</h1> <p>I snuffed out a <code class="language-plaintext highlighter-rouge">textcomplexity</code> python package on pip, but documentation on how to use it was relatively lax. Thankfully, due to the beauty of python, jupyter notebooks, a lonely and minorly alcoholic friday night, and smashing my head against the keyboard for 2 hours, I had a complete analysis script. It wasn’t <em>good</em>, but functional. At a high level, for each PDF, it:</p> <ul> <li>Parsed the PDF with PyPDF2</li> <li>Extracted all text from the document</li> <li>Counted all pictures in the document</li> <li>Did some metadata cross referencing with invariants on the openworks generated front page</li> <li>Handed the raw text into a <code class="language-plaintext highlighter-rouge">Stanza</code> NLP pipeline to convert text to CONLL-U format</li> <li>Tossed the Conll-U into <code class="language-plaintext highlighter-rouge">textcomplexity</code> to get the end lexical statistics about the IS rawtext</li> <li>Wrote all data to a file</li> </ul> <p>There are many opportunities for failure here, so my script was littered with <code class="language-plaintext highlighter-rouge">try/except</code> control flow handling, which slowed down the script but made it more resilient to failures. So… I started running this on my laptop, and went to bed.</p> <centering><b>The next day, I had 250 complete results, with 750 failures</b></centering> <p>Well.</p> <p>That.</p> <p>Sucks?!?!</p> <p>Further digging into the script, and a desire to be able to use my laptop for like… schoolwork… I transitioned the jupyter notebook over to my Linux Desktop. Creating an entirely new python venv, redownloading all the dependencies… up and running again! So now, I ran the script and got more successes, but each paper was taking 5-10 minutes. Entirely too long! Some further digging, and I quickly identified the largest timesink of the program is converting rawtexts to <code class="language-plaintext highlighter-rouge">.conllu</code> format. Inside a stanza script, I wasn’t utilizing my GPU, for dependency parsing, tokenizing, etc. etc.</p> <p>Ok, GPU acceleration enabled on a GTX 1060 6GB (my computer is old, hush hush). Start this in the background and… run for 72 hours. Ran through all of the ISes at least! But with about a 50 % fail rate, primarily from 50% of the papers unable to be processed and converted to <code class="language-plaintext highlighter-rouge">.conllu</code>. I diagnose the error to be CUDA running out of memory. So <strong>obviously</strong>, the correct solution here is to</p> <centering><b>buy a new graphics card.</b></centering> <p>A week later, I have an RTX 3060 12 GB swapped in. Lets run this script one more time… and, same issue. <code class="language-plaintext highlighter-rouge">CUDA Out Of Memory Error: ... Wants 17 GB (???), 1 GB Available</code> Hmm. Maybe I should read the error stacktrace. Ah, its coming from Stanza’s POS pipeline segment. Maybe I should <a href="https://stanfordnlp.github.io/stanza/pos.html" rel="external nofollow noopener" target="_blank">look at documentation</a> about how to fix this.</p> <p>Ok, lets set some limits on the pipeline processor:</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="n">nlp</span> <span class="o">=</span> <span class="n">stanza</span><span class="p">.</span><span class="nc">Pipeline</span><span class="p">(</span><span class="n">args</span><span class="p">.</span><span class="n">language</span><span class="p">,</span> 
        <span class="n">processors</span><span class="o">=</span><span class="sh">"</span><span class="s">tokenize,pos,lemma,depparse</span><span class="sh">"</span><span class="p">,</span>
        <span class="n">download_method</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
        <span class="n">use_gpu</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="c1"># lets use GPU
</span>        <span class="n">logging_level</span><span class="o">=</span><span class="sh">'</span><span class="s">ERROR</span><span class="sh">'</span><span class="p">,</span> 
        <span class="n">pos_batch_size</span><span class="o">=</span><span class="mi">1000</span>  <span class="c1"># limit part-of-speech batch size
</span>        <span class="p">)</span>
</code></pre></div></div> <p>Alright. Run this, still running into a few issues. A final workaround was to design a two-tiered processing pattern: First attempt to have the GPU analyze a paper, but if that fails, throw the CPU (and its much larger memory pool) at it compared to the GPU. After running this, I had <strong>significantly</strong> more luck with the analysis script, with an error rate of 15 some papers, ~&lt;1%, compared to 75%+ in the first pass and 50% in the second pass.</p> <p>If you are a visual person, here is a graphic the sums up this entire analysis pipeline step:</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/dataprocpipeline.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Data scraping, parsing, and processing pipeline for Independent Studies </div> <h1 id="results">Results</h1> <p>You can <a href="/assets/pdf/isanalyzerpaper.pdf">read the first draft</a> of the paper.</p> <p>The <a href="/assets/pdf/isanalyzerpaper_v2.pdf">final version</a> is complete now too.</p> <p>Finally, if you are interested in the raw R code used to generate the graphics in the above papers in addition to many graphics that didn’t make it into the final (8 page limited) paper, I am also making the <a href="/assets/pdf/isanalyzerpaper_appendix.pdf">project appendix</a> public.</p> <p>If you are interested in the dataset or analysis pipeline itself, reach out to me directly. Thanks for reading!</p> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2024 Patrick May. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Last updated: September 02, 2024. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="/assets/js/common.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>