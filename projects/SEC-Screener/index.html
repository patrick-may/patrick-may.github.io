<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>SEC Database AutoScreener | Patrick May</title> <meta name="author" content="Patrick May"> <meta name="description" content="Investment screening tool, built using polars and the public SEC API"> <meta name="keywords" content="jekyll, jekyll-theme, portfolio-website"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%92%BB&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://patrick-may.github.io/projects/SEC-Screener/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Patrick </span>May</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories</a> </li> <li class="nav-item "> <a class="nav-link" href="/resume/">resume</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">SEC Database AutoScreener</h1> <p class="post-description">Investment screening tool, built using polars and the public SEC API</p> </header> <article> <p>A deceptively difficult data analysis problem.</p> <h2 id="need">Need</h2> <p>As a college student heavily involved within the Jenny Investment Club, one of the United States’ oldest and largest fully student-run investment groups (we collectively handle over $10 million!!!), part of club operations involves having club members find stocks for us to invest within.</p> <p>As a club, we have a variety of different hard and soft guidelines to help us screen through stocks, such as:</p> <ul> <li><strong>1 - 10 billion market cap (inclusive)</strong></li> <li> <strong>ESG considerations</strong> (we are a middle eastern liberal arts college)</li> <li> <strong>Portfolio Diversification</strong>. Would this stock overexpose us to a certain sector’s risks?</li> <li> <strong><em>15% average growth, over 3 or 5 years in:</em></strong> <ul> <li>Cash Flow</li> <li>Revenue</li> <li>Income</li> </ul> </li> </ul> <p>The most difficult quantitative benchmarks to pass are the various 15% growth metrics. These are actually somewhat <em>hard</em> to find, because they are commonly not possible screening axes within free screeners, and booting up excel and tracking down historical company data across balance sheets and income statements is tedious, especially in the early stages of stock research.</p> <p>I wanted to solve this problem to make my fellow club members stock research jobs a little bit easier. I initially started using the <code class="language-plaintext highlighter-rouge">yfinance</code> package within python, however I ran into multiple difficulties very quickly, in limited scope of data, validity of data (sometimes just wrong??), etc.</p> <p>I then discovered that the SEC itself has a public API endpoint for looking up company information, documentation <a href="https://www.sec.gov/edgar/search-and-access" rel="external nofollow noopener" target="_blank">here</a>.</p> <h2 id="technologies">Technologies</h2> <p>As this is less of a software engineering project and closer to that of a data analysis problem, I tried to keep things as simple and easy to change as possible by using a <strong>jupyter notebook</strong> for the data.</p> <p>Additionally, as I knew I was going to be doing datawrangling with a project such as this. However, I am only a novice working within <code class="language-plaintext highlighter-rouge">pandas</code>, so I instead capitalized on the opportunity to work with <code class="language-plaintext highlighter-rouge">polars</code>, a new rust-based dataframe library!</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/polarslogo.svg" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="Enter PolaRS" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Enter polaRS, a rust-based, blazingly fast, concurrent datawrangling library. </div> <p>Polars has a multitude of benefits (and negatives) to consider, but for a simple project of my scale, anything would do, so why not dip my toes into the polars syntax?</p> <p>Additionally, I was doing <code class="language-plaintext highlighter-rouge">RESTful API</code> queries, so I utilized some very simple functionality that comes with python’s built in <code class="language-plaintext highlighter-rouge">requests</code> library.</p> <p>Then, you would imagine the problem is pretty simple, correct? Just:</p> <ul> <li>Follow SEC instructions to get all company CIKs (their database’s lookup key)</li> <li>Find the CIK for a chosen stock of interest</li> <li>Construct API queries for information on stock about desired metrics</li> <li>Simple pct-change analysis</li> <li>Results</li> </ul> <p><em>… not quite …</em></p> <h2 id="xbrl-and-why-i-wont-be-a-business-person">xBrl (and why I won’t be a business person)</h2> <p>xBrl, or e<strong>X</strong>tensible <strong>B</strong>usiness <strong>R</strong>eporting <strong>L</strong>anguage is a <em>somewhat</em> standardized flavor of XML for understanding business reports from companies, such as 10-Ks, 8-Ks, 20-Fs (for foriegn companies), etc. Without getting into the details of constructing specific API queries, it is easiest to get historical data of a <strong>specific</strong> xBrl tag. For example, if I identify the <em>Revenues</em> xBrl tag, then I can get the historical amounts for every form in a specific company’s record. Then pipe this to filter for only yearly reports, and it <em>should</em> be easy to have a YoY percent change for our desired metric.</p> <p>However… there is a big assumption here, in that the company is going to <em>always</em> going to tag their choice financial data under the <em>exact</em> same xBrl tag. For example, here is a example output after cleaning and filtering a query on <code class="language-plaintext highlighter-rouge">$AAPL</code>:</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/aaplstats.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="Tagging Inconsitencies: See Revenue Column" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>Here, it is obvious that the query for <code class="language-plaintext highlighter-rouge">revenue</code> didn’t use the right xBrl tag. Looking into it, that column was made with <code class="language-plaintext highlighter-rouge">"RevenuesTotal"</code> as the API endpoint. So, below are two more graphics. One is another AAPL query with a different <code class="language-plaintext highlighter-rouge">Revenues</code> endpoint. Another is a query on a different company, <em>still</em> with the “RevenuesTotal” endpoint tag.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/aaplstats2.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="Changed AAPL Tag" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/peristats.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="xBrl Insanity" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>So here, we see the root of the issue: while companies tend to be <em>self consistent</em> in their business tags (but not always), they <em>differ</em> from business to business as far as I can tell. Additionally, there does not seem to be a completely standardized selection of which xBrl tag is used – although there are a few that are the most common, it is entirely possible that some companies will use a completely different tag for a certain accounting number.</p> <p>I have faced a lot of challenge in trying to think of a <em>repeatable</em>, <em>short</em>, and <em>quick to-implement</em> solution to this problem, and have not had a ton of luck. For this scale of project, I believe it would be a rabbit hole to go down if I were to try and use CV parsing libraries to extract a specific xBrl tag, although larger companies and paid APIs do complete this service, I believe.</p> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2024 Patrick May. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Last updated: September 02, 2024. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="/assets/js/common.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>